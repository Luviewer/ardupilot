# hw definition file for MATEK M9N-F405
env AP_PERIPH 1

# MCU class and specific type
MCU STM32F4xx STM32F405xx

# bootloader starts firmware at 64k
FLASH_RESERVE_START_KB 64
FLASH_SIZE_KB 1024

# store parameters in pages 2 and 3
STORAGE_FLASH_PAGE 2
define HAL_STORAGE_SIZE 15360

# board ID for firmware load
APJ_BOARD_ID 1014

define STM32_ST_USE_TIMER 5
define CH_CFG_ST_RESOLUTION 32

# crystal frequency
OSCILLATOR_HZ 8000000

# blue LED0 marked as ACT
PC9 LED OUTPUT HIGH GPIO(90)
define AP_NOTIFY_GPIO_LED_1_ENABLED  1
define AP_NOTIFY_GPIO_LED_1_PIN  90

define HAL_NO_GPIO_IRQ
define SERIAL_BUFFERS_SIZE 512
define PORT_INT_REQUIRED_STACK 64

# debug
PA13 JTMS-SWDIO SWD
PA14 JTCK-SWCLK SWD

# avoid timer and RCIN threads to save memory
define HAL_NO_RCIN_THREAD

define HAL_USE_RTC FALSE
define DISABLE_SERIAL_ESC_COMM TRUE

define DMA_RESERVE_SIZE 0

define HAL_DEVICE_THREAD_STACK 768

# we setup a small defaults.parm
define AP_PARAM_MAX_EMBEDDED_PARAM 256

# keep ROMFS uncompressed as we don't have enough RAM
# to uncompress the bootloader at runtime
env ROMFS_UNCOMPRESSED True

# -------------------- CAN bus ---------------------
PA11 CAN1_RX CAN1
PA12 CAN1_TX CAN1

define CAN_APP_NODE_NAME "USBF4-CAN"

# --------------------- UARTs ---------------------------
SERIAL_ORDER USART1 USART6 USART3 USART2

# USART1
PA9  USART1_TX USART1
PA10 USART1_RX USART1

# USART2
# alternative using USART2
PC6 USART6_TX USART6
PC7 USART6_RX USART6 

# USART3
PB10  USART3_TX USART3
PB11  USART3_RX USART3

# UART4, for GPS
PA2 USART2_TX USART2
PA3 USART2_RX USART2

define HAL_USE_ADC FALSE
